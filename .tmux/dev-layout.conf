# Development Layout - Rails with Risk Monitoring
# Split screen for editor, server, console, and monitoring

# Create windows
new-window -n 'Editor'
new-window -n 'Server'
new-window -n 'Console'
new-window -n 'Tests'
new-window -n 'Monitor'

# Editor window - main coding
select-window -t 'Editor'
send-keys 'nvim .' C-m

# Server window - Rails server and logs
select-window -t 'Server'
split-window -h -p 40
select-pane -t 0
send-keys 'rails server' C-m
select-pane -t 1
send-keys 'tail -f log/development.log' C-m

# Console window - Rails console and database
select-window -t 'Console'
split-window -h -p 50
select-pane -t 0
send-keys 'rails console' C-m
select-pane -t 1
send-keys 'rails db' C-m

# Tests window - continuous testing
select-window -t 'Tests'
split-window -h -p 50
split-window -v -p 50
select-pane -t 0
send-keys 'guard' C-m
select-pane -t 1
send-keys 'rails test:system --headless' C-m

# Monitor window - performance and risks
select-window -t 'Monitor'
split-window -h -p 50
split-window -v -p 50
select-pane -t 0
send-keys 'htop' C-m
select-pane -t 1
send-keys 'watch -n 5 "rails runner \"puts Rails.cache.stats\"' C-m

# Select the Editor window to start
select-window -t 'Editor'